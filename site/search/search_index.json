{"config":{"indexing":"full","lang":["fr"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Voici les diff\u00e9rents cours pr\u00e9sents et document\u00e9s Type Formation Cours Date Linux Administration avanc\u00e9e Installation avanc\u00e9e CENTOS9 01/12/2022 Linux Administration avanc\u00e9e RPM et YUM 02/12/2022 Windows PowerShell Cr\u00e9ation d'un dossier et d'un script 06/12/2022 Windows PowerShell Cr\u00e9ation d'un fichier avec user et date 06/12/2022 Linux Administration LVM 01/06/2022 Windows AD Cr\u00e9ation d'une GPO 07/12/2022","title":"Home"},{"location":"Linux/Bachelor/LVM/","text":"Mise en place des partitions \u00b6 D\u00e9couverte des disques \u00b6 Emplacement des disques \u00b6 /dev/sda sda = Premier disque sdb = Second disque De mani\u00e8re g\u00e9n\u00e9rale sd x avec le x qui est le disque (par ordre aphab\u00e9tique) Partitions des disques \u00b6 /dev/sda1 sda1 = Premi\u00e8re partition du disque sda2 = Seconde partition du disque De mani\u00e8re g\u00e9\u00e9nrale sd x z avec z qui le num\u00e9ro de la partition. Cr\u00e9ation des partitions \u00b6 Liste des partitions \u00b6 1 partition swap 1 partition filesystem 3 partition LVM 3 partitions RAID Commande : fdisk /dev/sdb Pour acc\u00e8der au menu : m pour l'aide de la commande Cr\u00e9ation de la nouvelle table en GPT : g Cr\u00e9ation de la nouvelle partition : n -> Num\u00e9ro de partition -> Premier secteur -> Dernier secteur (possibilit\u00e9 de mettre un espace en K,M,G,T,P) Cr\u00e9ation du type de la partition : t -> Num\u00e9ro de la partition \u00e0 modifier -> Num\u00e9ro ou alias de type de partition Mise en place de sauvegarde \u00b6 Mise en place de l'archive de sauvegarde \u00b6 Sauvegarde : tar -cvz -f /home.tar.gz /home -> -c = Cr\u00e9ation d'archive -> -v = Verbose -> -z = Compression du fichier -> -f = Nom de l'archive (Toujours cette option en derni\u00e8re) Test de l'archive : tar -tf /home.tar.gz -> -t = pour tester l'archive -> -f = sp\u00e9cification du fichier (Toujours cette option en derni\u00e8re) Mise en place du nouveau /home \u00b6 Vidange du r\u00e9pertoire \u00b6 Plusieurs fa\u00e7on de vider le r\u00e9pertoire /home : rm -rf /home ; mkdir /home ou rm -rf /home/* Attention \u00e0 ne pas mettre d'espace entre / et home car cela supprimerais tout le syst\u00e8me de fichier. Mise en place du formatage \u00b6 Formatage en EXT4 pour la partition FileSystem : mkfs.ext4 /dev/sdb2 Message d'erreur si la partition est d\u00e9j\u00e0 format\u00e9e Obtenir l'UUID d'une partition : lsblk -o uuid -n /dev/sdb2 Modification de fstab : nano /etc/fstab Montage de la partition et test si fstab est correct: sudo mount -av Restauration de l'archive \u00b6 sudo tar -C / -xf /home.tar.gz ls -l /home Vigilance sur la taille du syst\u00e8me de fichier sinon l'extraction ne focntionnera pas. LVM \u00b6 Commandes LVM2 \u00b6 Scan des partitions LVM : pvs alias => pvscan Cr\u00e9ation disques physiques pour les volumes logiques : pvcreate /dev/sdb3 /dev/sdb4 /dev/sdb5 alias => pvcreate /dev/sdb{3..5} Cr\u00e9ation d'un volume logique vgdata vgcreate vgdata /dev/sdb3 lsblk pour affihcer tout les volumes VG => Volume groupe L'extention de VG prends des volumes physiques sudo vgextend vgdata /dev/sdb4 LV => Logical Volume - pour utiliser les commandes \u00e0 partir de PV.... , on parle de volume physique. PV => Physical volume Commandes pour afficher les volumes \u00b6 pvscan lvscan pvscan Suppression des volumes \u00b6 La suppression des volumes entraine la suppression des donn\u00e9es stock\u00e9es sur le logical volume D\u00e9montage des volumes en premier : unmount \\data Suppression du volume logique : lvremove /dev/rootvg/lvdata Suppression du volume groupe : vgremove /dev/rootvg Suppression des volumes physique : pvremove /dev/sdb3 /dev/sdb4 /dev/sdb5 Modification du fstab pour ne pas demarrer en mode recovery RAID \u00b6 Installation \u00b6 Installation via ansible \u00b6 Installer ansible apt install ansible Installation de mdadm : ansible localhost -m package -a \"name=mdadm state=latest\" Cr\u00e9ation du raid \u00b6 Mise en place du raid avec 1 disque manaquant (d'o\u00f9 l'option missing ) : mdadm --create /dev/md0 --level 1 --raid-device 2 /dev/sdb6 missing Status du raid : mdadm --detail /dev/md0 Ajout d'un disque : mdadm --manage /dev/md0 --add /dev/sdb7 Disque HS : mdadm /dev/md0 --fail /dev/sdb6 Retirer le disque : mdadm /dev/md0 --remove /dev/sdb6 Montage de /data via ansible : ansible localhost -m mount -a \"src=/dev/md0 path=/data state=mounted\" Recherche dans la doc ansible-doc -l |grep -i --color filesystem Montage via l'UUID : ansible localhost -m mount -a \"src= '-U 07684c31-dd62-45be-82bb-a72cae950930 name=/data fstype=ext4 state=present'\" formatage avec l'UUID : ansible localhost -m filesystem -a \"dev=/dev/md0 fstype=ext4 state=present opts='-U 06b4a9c3-9487-4685-a672-d28b6df2b5f6'\" cible de anible playbook : ansible-playbook make-filesystem.yml Deployment ansible \u00b6 G\u00e9n\u00e9ration des cl\u00e9s SSH \u00b6 G\u00e9n\u00e9ration de la cl\u00e9 : ssh-keygen Mise en place de la cl\u00e9 : ssh-copy-id 127.0.0.1 Demande une derni\u00e8re fois un mot de passe pour confirmer l'ajout Mise en place des privil\u00e8ges : nano /etc/sudoers # User privilege specification root ALL =( ALL:ALL ) NOPASSWD: ALL # Allow members of group sudo to execute any command %sudo ALL =( ALL:ALL ) NOPASSWD: ALL rajout de l'option NOPASSWD: Test ansible ping \u00b6 Mise en place de l'inventaire : echo \"debian-locale ansible_host=127.0.0.1\" >> inventaire.txt Dans le fichier ansible.cfg , ajout de redirecteurs : 1 2 3 4 [defaults] deprecation_warnings = False //enl\u00e8vement des warnings inventory = inventaire.txt // redirecteur Commande de ping : ansible all -m ping -o Boot d'une machine \u00b6 D\u00e9marrage \u00b6 MBR : Master boot record Sous windows on utilise pas le bootloader. On va utiliser le premier secteur bootable sur le disque. (pas de programme d'ammorcage) RO = Read only dans les options de d\u00e9marrage D\u00e9marrage du syst\u00e8me : Construction du syst\u00e8me de base D\u00e9marrage des services Lancements de taches dites \"supervis\u00e9e\" comme le lancement d'une session Systemctl status permet d'obtenir des informations globalement sur la machine et donne l'\u00e9tat g\u00e9n\u00e9ral de tout les services lanc\u00e9s avec ceux qui sont failed et running. Mise en place d'un /data avec /etc/systemd/system/data.mount : 1 2 3 4 5 6 7 8 [Unit] [Mount] What = UUID=915bcbeb-c17a-44e9-9e4f-beb8b79b724c Where = /data Type = ext4 Options = defaults Passage avec ansible \u00b6 Mise en place de l'invetaire en yml avec ansible-inventory -y --list (option -y pour yaml/yml) Modification du fichier ansible.cfg pour int\u00e9grer l'invetaire en yml 1 2 3 4 [defaults] deprecation_warnings = False //enl\u00e8vement des warnings inventory = inventaire.yml // redirecteur Timer \u00b6 sudo nano /etc/systemd/system/compteur.timer Modifier une conf \u00b6 systemctl edit xx.socket Logs \u00b6 Mise en place de rsyslog avec envoi de msg sur un autre serveur \u00b6 Installation du package rsyslog-relp avec apt. Modification de la conf de /etc/rsyslog.conf : module(load=\"omrelp\") module(load=\"immark\" interval=\"180\") local1.info :omrelp:IP:PORT envoi d'un msg sudo logger -p local1.info -t \"tag-du-jour\" \"J'ai r\u00e9ussi \" Mise en place avec Ansible \u00b6 Mise en place d'un dossier roles mkdir roles Cr\u00e9ation des fichier li\u00e9s au roles ansible-galaxy role init roles/rsyslog Fichier de configuration des tasks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 --- # tasks file for roles/rsyslog - name: maj derni\u00e8re version apt: name: \"*\" state: latest - name: install Rsyslog package: name: rsyslog state: latest - name: install Rsyslog_relp package: name: rsyslog-relp state: latest - name: D\u00e9marrer et activer rsyslog ansible.builtin.service: name: \"{{ rsyslog_service }}\" state: started enabled: yes - name: Mise en place de la Config template: src: rsyslog_relp.j2 dest: \"/etc/rsyslog.d/rsyslog-relp.conf\" owner: root group: root mode: \"0644\" notify: restart-rsyslog Mise en place des des variables dans defaults : 1 2 relp_port: 0000 relp_server: 1.2.3.4 Configuration d'un template : 1 2 3 4 5 6 7 8 9 [Unit] Description= Mise en place de RELP [Service] module(load=\"omrelp\") module(load=\"immark\" interval=\"180\") *.info :omrelp:{{relp_server}}:{{relp_port}} Logs \u00b6 Plusieurs application de logs : journalctl rsyslog => Les configuruations de rsyslog permettent de pouvoir conserver des donn\u00e9es suivant le poids d'un fichier, le nombre de jours, ...","title":"Mise en place des partitions"},{"location":"Linux/Bachelor/LVM/#mise-en-place-des-partitions","text":"","title":"Mise en place des partitions"},{"location":"Linux/Bachelor/LVM/#decouverte-des-disques","text":"","title":"D\u00e9couverte des disques"},{"location":"Linux/Bachelor/LVM/#emplacement-des-disques","text":"/dev/sda sda = Premier disque sdb = Second disque De mani\u00e8re g\u00e9n\u00e9rale sd x avec le x qui est le disque (par ordre aphab\u00e9tique)","title":"Emplacement des disques"},{"location":"Linux/Bachelor/LVM/#partitions-des-disques","text":"/dev/sda1 sda1 = Premi\u00e8re partition du disque sda2 = Seconde partition du disque De mani\u00e8re g\u00e9\u00e9nrale sd x z avec z qui le num\u00e9ro de la partition.","title":"Partitions des disques"},{"location":"Linux/Bachelor/LVM/#creation-des-partitions","text":"","title":"Cr\u00e9ation des partitions"},{"location":"Linux/Bachelor/LVM/#liste-des-partitions","text":"1 partition swap 1 partition filesystem 3 partition LVM 3 partitions RAID Commande : fdisk /dev/sdb Pour acc\u00e8der au menu : m pour l'aide de la commande Cr\u00e9ation de la nouvelle table en GPT : g Cr\u00e9ation de la nouvelle partition : n -> Num\u00e9ro de partition -> Premier secteur -> Dernier secteur (possibilit\u00e9 de mettre un espace en K,M,G,T,P) Cr\u00e9ation du type de la partition : t -> Num\u00e9ro de la partition \u00e0 modifier -> Num\u00e9ro ou alias de type de partition","title":"Liste des partitions"},{"location":"Linux/Bachelor/LVM/#mise-en-place-de-sauvegarde","text":"","title":"Mise en place de sauvegarde"},{"location":"Linux/Bachelor/LVM/#mise-en-place-de-larchive-de-sauvegarde","text":"Sauvegarde : tar -cvz -f /home.tar.gz /home -> -c = Cr\u00e9ation d'archive -> -v = Verbose -> -z = Compression du fichier -> -f = Nom de l'archive (Toujours cette option en derni\u00e8re) Test de l'archive : tar -tf /home.tar.gz -> -t = pour tester l'archive -> -f = sp\u00e9cification du fichier (Toujours cette option en derni\u00e8re)","title":"Mise en place de l'archive de sauvegarde"},{"location":"Linux/Bachelor/LVM/#mise-en-place-du-nouveau-home","text":"","title":"Mise en place du nouveau /home"},{"location":"Linux/Bachelor/LVM/#vidange-du-repertoire","text":"Plusieurs fa\u00e7on de vider le r\u00e9pertoire /home : rm -rf /home ; mkdir /home ou rm -rf /home/* Attention \u00e0 ne pas mettre d'espace entre / et home car cela supprimerais tout le syst\u00e8me de fichier.","title":"Vidange du r\u00e9pertoire"},{"location":"Linux/Bachelor/LVM/#mise-en-place-du-formatage","text":"Formatage en EXT4 pour la partition FileSystem : mkfs.ext4 /dev/sdb2 Message d'erreur si la partition est d\u00e9j\u00e0 format\u00e9e Obtenir l'UUID d'une partition : lsblk -o uuid -n /dev/sdb2 Modification de fstab : nano /etc/fstab Montage de la partition et test si fstab est correct: sudo mount -av","title":"Mise en place du formatage"},{"location":"Linux/Bachelor/LVM/#restauration-de-larchive","text":"sudo tar -C / -xf /home.tar.gz ls -l /home Vigilance sur la taille du syst\u00e8me de fichier sinon l'extraction ne focntionnera pas.","title":"Restauration de l'archive"},{"location":"Linux/Bachelor/LVM/#lvm","text":"","title":"LVM"},{"location":"Linux/Bachelor/LVM/#commandes-lvm2","text":"Scan des partitions LVM : pvs alias => pvscan Cr\u00e9ation disques physiques pour les volumes logiques : pvcreate /dev/sdb3 /dev/sdb4 /dev/sdb5 alias => pvcreate /dev/sdb{3..5} Cr\u00e9ation d'un volume logique vgdata vgcreate vgdata /dev/sdb3 lsblk pour affihcer tout les volumes VG => Volume groupe L'extention de VG prends des volumes physiques sudo vgextend vgdata /dev/sdb4 LV => Logical Volume - pour utiliser les commandes \u00e0 partir de PV.... , on parle de volume physique. PV => Physical volume","title":"Commandes LVM2"},{"location":"Linux/Bachelor/LVM/#commandes-pour-afficher-les-volumes","text":"pvscan lvscan pvscan","title":"Commandes pour afficher les volumes"},{"location":"Linux/Bachelor/LVM/#suppression-des-volumes","text":"La suppression des volumes entraine la suppression des donn\u00e9es stock\u00e9es sur le logical volume D\u00e9montage des volumes en premier : unmount \\data Suppression du volume logique : lvremove /dev/rootvg/lvdata Suppression du volume groupe : vgremove /dev/rootvg Suppression des volumes physique : pvremove /dev/sdb3 /dev/sdb4 /dev/sdb5 Modification du fstab pour ne pas demarrer en mode recovery","title":"Suppression des volumes"},{"location":"Linux/Bachelor/LVM/#raid","text":"","title":"RAID"},{"location":"Linux/Bachelor/LVM/#installation","text":"","title":"Installation"},{"location":"Linux/Bachelor/LVM/#installation-via-ansible","text":"Installer ansible apt install ansible Installation de mdadm : ansible localhost -m package -a \"name=mdadm state=latest\"","title":"Installation via ansible"},{"location":"Linux/Bachelor/LVM/#creation-du-raid","text":"Mise en place du raid avec 1 disque manaquant (d'o\u00f9 l'option missing ) : mdadm --create /dev/md0 --level 1 --raid-device 2 /dev/sdb6 missing Status du raid : mdadm --detail /dev/md0 Ajout d'un disque : mdadm --manage /dev/md0 --add /dev/sdb7 Disque HS : mdadm /dev/md0 --fail /dev/sdb6 Retirer le disque : mdadm /dev/md0 --remove /dev/sdb6 Montage de /data via ansible : ansible localhost -m mount -a \"src=/dev/md0 path=/data state=mounted\" Recherche dans la doc ansible-doc -l |grep -i --color filesystem Montage via l'UUID : ansible localhost -m mount -a \"src= '-U 07684c31-dd62-45be-82bb-a72cae950930 name=/data fstype=ext4 state=present'\" formatage avec l'UUID : ansible localhost -m filesystem -a \"dev=/dev/md0 fstype=ext4 state=present opts='-U 06b4a9c3-9487-4685-a672-d28b6df2b5f6'\" cible de anible playbook : ansible-playbook make-filesystem.yml","title":"Cr\u00e9ation du raid"},{"location":"Linux/Bachelor/LVM/#deployment-ansible","text":"","title":"Deployment ansible"},{"location":"Linux/Bachelor/LVM/#generation-des-cles-ssh","text":"G\u00e9n\u00e9ration de la cl\u00e9 : ssh-keygen Mise en place de la cl\u00e9 : ssh-copy-id 127.0.0.1 Demande une derni\u00e8re fois un mot de passe pour confirmer l'ajout Mise en place des privil\u00e8ges : nano /etc/sudoers # User privilege specification root ALL =( ALL:ALL ) NOPASSWD: ALL # Allow members of group sudo to execute any command %sudo ALL =( ALL:ALL ) NOPASSWD: ALL rajout de l'option NOPASSWD:","title":"G\u00e9n\u00e9ration des cl\u00e9s SSH"},{"location":"Linux/Bachelor/LVM/#test-ansible-ping","text":"Mise en place de l'inventaire : echo \"debian-locale ansible_host=127.0.0.1\" >> inventaire.txt Dans le fichier ansible.cfg , ajout de redirecteurs : 1 2 3 4 [defaults] deprecation_warnings = False //enl\u00e8vement des warnings inventory = inventaire.txt // redirecteur Commande de ping : ansible all -m ping -o","title":"Test ansible ping"},{"location":"Linux/Bachelor/LVM/#boot-dune-machine","text":"","title":"Boot d'une machine"},{"location":"Linux/Bachelor/LVM/#demarrage","text":"MBR : Master boot record Sous windows on utilise pas le bootloader. On va utiliser le premier secteur bootable sur le disque. (pas de programme d'ammorcage) RO = Read only dans les options de d\u00e9marrage D\u00e9marrage du syst\u00e8me : Construction du syst\u00e8me de base D\u00e9marrage des services Lancements de taches dites \"supervis\u00e9e\" comme le lancement d'une session Systemctl status permet d'obtenir des informations globalement sur la machine et donne l'\u00e9tat g\u00e9n\u00e9ral de tout les services lanc\u00e9s avec ceux qui sont failed et running. Mise en place d'un /data avec /etc/systemd/system/data.mount : 1 2 3 4 5 6 7 8 [Unit] [Mount] What = UUID=915bcbeb-c17a-44e9-9e4f-beb8b79b724c Where = /data Type = ext4 Options = defaults","title":"D\u00e9marrage"},{"location":"Linux/Bachelor/LVM/#passage-avec-ansible","text":"Mise en place de l'invetaire en yml avec ansible-inventory -y --list (option -y pour yaml/yml) Modification du fichier ansible.cfg pour int\u00e9grer l'invetaire en yml 1 2 3 4 [defaults] deprecation_warnings = False //enl\u00e8vement des warnings inventory = inventaire.yml // redirecteur","title":"Passage avec ansible"},{"location":"Linux/Bachelor/LVM/#timer","text":"sudo nano /etc/systemd/system/compteur.timer","title":"Timer"},{"location":"Linux/Bachelor/LVM/#modifier-une-conf","text":"systemctl edit xx.socket","title":"Modifier une conf"},{"location":"Linux/Bachelor/LVM/#logs","text":"","title":"Logs"},{"location":"Linux/Bachelor/LVM/#mise-en-place-de-rsyslog-avec-envoi-de-msg-sur-un-autre-serveur","text":"Installation du package rsyslog-relp avec apt. Modification de la conf de /etc/rsyslog.conf : module(load=\"omrelp\") module(load=\"immark\" interval=\"180\") local1.info :omrelp:IP:PORT envoi d'un msg sudo logger -p local1.info -t \"tag-du-jour\" \"J'ai r\u00e9ussi \"","title":"Mise en place de rsyslog avec envoi de msg sur un autre serveur"},{"location":"Linux/Bachelor/LVM/#mise-en-place-avec-ansible","text":"Mise en place d'un dossier roles mkdir roles Cr\u00e9ation des fichier li\u00e9s au roles ansible-galaxy role init roles/rsyslog Fichier de configuration des tasks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 --- # tasks file for roles/rsyslog - name: maj derni\u00e8re version apt: name: \"*\" state: latest - name: install Rsyslog package: name: rsyslog state: latest - name: install Rsyslog_relp package: name: rsyslog-relp state: latest - name: D\u00e9marrer et activer rsyslog ansible.builtin.service: name: \"{{ rsyslog_service }}\" state: started enabled: yes - name: Mise en place de la Config template: src: rsyslog_relp.j2 dest: \"/etc/rsyslog.d/rsyslog-relp.conf\" owner: root group: root mode: \"0644\" notify: restart-rsyslog Mise en place des des variables dans defaults : 1 2 relp_port: 0000 relp_server: 1.2.3.4 Configuration d'un template : 1 2 3 4 5 6 7 8 9 [Unit] Description= Mise en place de RELP [Service] module(load=\"omrelp\") module(load=\"immark\" interval=\"180\") *.info :omrelp:{{relp_server}}:{{relp_port}}","title":"Mise en place avec Ansible"},{"location":"Linux/Bachelor/LVM/#logs_1","text":"Plusieurs application de logs : journalctl rsyslog => Les configuruations de rsyslog permettent de pouvoir conserver des donn\u00e9es suivant le poids d'un fichier, le nombre de jours, ...","title":"Logs"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/","text":"Centos \u00b6 kickstart (redhat) = methode d'installation qui permet de faire passer les questions d'installation utilisation avec la modification de l'ecran d'installation Proc\u00e9dure \u00b6 installation manuellement R\u00e9cuparation du fichier /rot/anaconda-ks.cfg --> /srv/ks.cfg Mettre le fichier \u00e0 disposition avec un client http = conteneur docker Installation nouvelle VM avec l'utilisation du fichier KS inst.ks=https://...../ks.cfg si probl\u00e8me r\u00e9solution : inst.resolution=1080x1920 Cahier des charges \u00b6 3 partitions : /boot : 500Mo, format ext2 Swap : 1Go Syst\u00e8me de fichier racine (/), ext4, 3 Go, mais sur du LVM, volume groupe = rootvg, volume logique = rootlv Rappels \u00b6 LVM : Logical Volume Manager PV : Physical volume VG : Volume Volume (prends l'int\u00e9gralit\u00e9 des PV) LG : Logical Volume (Volumes logiques cr\u00e9es sur le VG et permet d'utiliser des systemes de fichier diff\u00e9rents) exemples : LV1 /leo (ext4) LV2 /data1 (EXT3) LV3 /data2 (EXT4) Sch\u00e9ma de LVM Installation CENTOS9 \u00b6 Choix du clavier Mise en place du partitionnement Installation docker \u00b6 Rappel sur docker Site de documentation docker : https://docs.docker.com Selon la firme de recherche sur l'industrie 451 Research, \u00ab Docker est un outil qui peut empaqueter une application et ses d\u00e9pendances dans un conteneur isol\u00e9, qui pourra \u00eatre ex\u00e9cut\u00e9 sur n'importe quel serveur \u00bb. Il ne s'agit pas de virtualisation, mais de conteneurisation, une forme plus l\u00e9g\u00e8re qui s'appuie sur certaines parties de la machine h\u00f4te pour son fonctionnement. Copier le fichier ananconda cp anaconda-ks.cfg /srv/kickstart/ks.cfg installer docker avec CURL curl -sSL https://get.docker.com | sudo bash ou sinon : curl -sSl -o get-docker.sh https://get.docker.com controle : get-docker.sh execution : bash get-docker.sh Demarrage et automatisation de docker au boot systemctl enable --now docker.service D\u00e9marrage d'un conteneur de serveur web Apache - > docker container run -d --name websrv --publish 80:80 --volume /srv/kickstart:/usr/local/apache2/htdocs httpd Ngnix - > docker container run -d --name websrv --publish 80:80 --volume /srv/kickstart:/usr/share/nginx/html nginx Verficiation des user dans docker docker container top websrv Mise \u00e0 jour des permissions chmod 644 /srv/kickstart/ks.cfg Installation de micro curl https://getmic.ro | bash mv micro /usr/local/bin ln -s /usr/local/bin/micro /usr/local/sbin/micro Changement pour enlever le mot de passe de user sed -i -e '/ %wheel/s, ,# ,' -e '/^# %wheel.*NOPASSWD/s,^# ,,' /etc/sudoers Le -i prend en compte pour l'execution Mise en place de l'anaconda pour installer d'autres machines \u00b6 Cahier des charges \u00b6 \"micro\" doit etre install\u00e9 dans /usr/local/bin Lien symbolique dans /usr/local/bin User n'a pas \u00e0 s'identifier pour sudo ... No PASSWD On ne peut se connecter en trannt que \"user\" avec une cl\u00e9 punlique definie ici Extention du volume groupe \u00b6 Cr\u00e9ation du volume dans le sdb pvcreate /dev/sdb Extentention du volume groupe sur le nouveau disque vgextend /dev/rootvg /dev/sdb Extention du volume logique lvextend -l 100%FREE -r /dev/rootvg/rootlv modification du SSH \u00b6 Cr\u00e9ation des dossier ssh (/.ssh/authorized_keys) .ssh avec les droits 700 authorized_keys avec les droits 600 Debian \u00b6 Preseed (debian) = methode d'installation qui permet de faire passer les questions d'installation","title":"Centos"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#centos","text":"kickstart (redhat) = methode d'installation qui permet de faire passer les questions d'installation utilisation avec la modification de l'ecran d'installation","title":"Centos"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#procedure","text":"installation manuellement R\u00e9cuparation du fichier /rot/anaconda-ks.cfg --> /srv/ks.cfg Mettre le fichier \u00e0 disposition avec un client http = conteneur docker Installation nouvelle VM avec l'utilisation du fichier KS inst.ks=https://...../ks.cfg si probl\u00e8me r\u00e9solution : inst.resolution=1080x1920","title":"Proc\u00e9dure"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#cahier-des-charges","text":"3 partitions : /boot : 500Mo, format ext2 Swap : 1Go Syst\u00e8me de fichier racine (/), ext4, 3 Go, mais sur du LVM, volume groupe = rootvg, volume logique = rootlv","title":"Cahier des charges"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#rappels","text":"LVM : Logical Volume Manager PV : Physical volume VG : Volume Volume (prends l'int\u00e9gralit\u00e9 des PV) LG : Logical Volume (Volumes logiques cr\u00e9es sur le VG et permet d'utiliser des systemes de fichier diff\u00e9rents) exemples : LV1 /leo (ext4) LV2 /data1 (EXT3) LV3 /data2 (EXT4) Sch\u00e9ma de LVM","title":"Rappels"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#installation-centos9","text":"Choix du clavier Mise en place du partitionnement","title":"Installation CENTOS9"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#installation-docker","text":"Rappel sur docker Site de documentation docker : https://docs.docker.com Selon la firme de recherche sur l'industrie 451 Research, \u00ab Docker est un outil qui peut empaqueter une application et ses d\u00e9pendances dans un conteneur isol\u00e9, qui pourra \u00eatre ex\u00e9cut\u00e9 sur n'importe quel serveur \u00bb. Il ne s'agit pas de virtualisation, mais de conteneurisation, une forme plus l\u00e9g\u00e8re qui s'appuie sur certaines parties de la machine h\u00f4te pour son fonctionnement. Copier le fichier ananconda cp anaconda-ks.cfg /srv/kickstart/ks.cfg installer docker avec CURL curl -sSL https://get.docker.com | sudo bash ou sinon : curl -sSl -o get-docker.sh https://get.docker.com controle : get-docker.sh execution : bash get-docker.sh Demarrage et automatisation de docker au boot systemctl enable --now docker.service D\u00e9marrage d'un conteneur de serveur web Apache - > docker container run -d --name websrv --publish 80:80 --volume /srv/kickstart:/usr/local/apache2/htdocs httpd Ngnix - > docker container run -d --name websrv --publish 80:80 --volume /srv/kickstart:/usr/share/nginx/html nginx Verficiation des user dans docker docker container top websrv Mise \u00e0 jour des permissions chmod 644 /srv/kickstart/ks.cfg Installation de micro curl https://getmic.ro | bash mv micro /usr/local/bin ln -s /usr/local/bin/micro /usr/local/sbin/micro Changement pour enlever le mot de passe de user sed -i -e '/ %wheel/s, ,# ,' -e '/^# %wheel.*NOPASSWD/s,^# ,,' /etc/sudoers Le -i prend en compte pour l'execution","title":"Installation docker"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#mise-en-place-de-lanaconda-pour-installer-dautres-machines","text":"","title":"Mise en place de l'anaconda pour installer d'autres machines"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#cahier-des-charges_1","text":"\"micro\" doit etre install\u00e9 dans /usr/local/bin Lien symbolique dans /usr/local/bin User n'a pas \u00e0 s'identifier pour sudo ... No PASSWD On ne peut se connecter en trannt que \"user\" avec une cl\u00e9 punlique definie ici","title":"Cahier des charges"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#extention-du-volume-groupe","text":"Cr\u00e9ation du volume dans le sdb pvcreate /dev/sdb Extentention du volume groupe sur le nouveau disque vgextend /dev/rootvg /dev/sdb Extention du volume logique lvextend -l 100%FREE -r /dev/rootvg/rootlv","title":"Extention du volume groupe"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#modification-du-ssh","text":"Cr\u00e9ation des dossier ssh (/.ssh/authorized_keys) .ssh avec les droits 700 authorized_keys avec les droits 600","title":"modification du SSH"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/Installation%20avanc%C3%A9e%20CENTOS%209/#debian","text":"Preseed (debian) = methode d'installation qui permet de faire passer les questions d'installation","title":"Debian"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/","text":"Programme du jour \u00b6 Manipuler rpm et yum Compiler un logiciel libre (\u00e0 partir des sources) Cr\u00e9er un pakcage RPM Cr\u00e9er un d\u00e9p\u00f4t pour mettre \u00e0 dispo mes packages D\u00e9clarer mon d\u00e9p\u00f4t sur les pc clients Manipuler rpm et yum \u00b6 RPM \u00b6 RPM : commande pour manipuler des package et savoir les informations sur ceux-ci Options : -q query => Information de version -qi => descriptif sur le paquage -qa => liste de tout les paquages install\u00e9s -ql => liste des fihcier install\u00e9 le paquet -qc => Liste des fihciers de config -qd => Liste des fichiers de docs -qf => savoir quel fichier \u00e0 install\u00e9 le package --requires (-R) => savoir les paquages dont il a besoin --provides (-P) => d\u00e9pendances pour qui ? --scripts => fichier spec avec les scripts de d\u00e9sinstall, install, preinstall YUM \u00b6 Yum : surcouche de rpm DNF = reprise de yum qui etait sur python 2.3 Options : install update upgrade (attention cela peut remplacer des paquets) remove list (liste tout les paquets) search (liste les paquets avec par exemple http dans les descriptions) provides Extraire une archive test de l'archive tar -tvzf ARCHIVE | tail options : - t pour tester ou lister (--list) - v versbose - f file - z compression - x pour extraire Le tail est utilis\u00e9 pour etre sur que tout les fichiers soient dans le meme dossier racine Extraction tar -xvzf ARCHIVE Verification des signatures GPG : \u00b6 Importer la cl\u00e9 avec WGET : wget https://download.samba.org/pub/rsync/src/rsync-3.2.7.tar.gz.asc Verification de la signature : gpg --verify rsync-3.2.7.tar.gz.asc Copie de la cl\u00e9 pour enregistrer la cl\u00e9 via un serveur de cl\u00e9s gpg --receive-keys 0048C8B026D4C96F0E589C2F6C859FB14B96A8C5 V\u00e9rifier \u00e0 nouveau la cl\u00e9 Paquet rsync \u00b6 Erreurs lors de la configuration Installation de GCC compilateur C dnf -y install gcc Nouvelle erreur lors de la configuration : On cherche les paquets openssl : yum provides \"*/openssl/md4.h\" On trouve ensuite les paquets openssl-devel dnf -y install gcc openssl-devel On retrouve plusieurs erreurs suppl\u00e9mentaires zstd lz4 xxhash Pour xxhash on va sur le site https://pkgs.org et on cherche un paquet qui se rapporte xxhash-devel On trouve le repo CRB : Commande compl\u00e8te avec tout les arguments : dnf --enablerepo=\"crb\" -y install gcc openssl-devel lz4-devel libzstd-devel xxhash-devel On retrouve ensuite le code retour avec la configuration termin\u00e9e : epel-release permet d'aller chercher des paquets qui ne sont pas soutenu par REDHAT mais par une autre communaut\u00e9 comme la communaut\u00e9 FEDORA Petite astuce pour savoir le nombre de coeur : grep -c ^processor /proc/cpuinfo RPM build \u00b6 Package rsync (non vide) \u00b6 3 options : b pour partir d'un fichier spec r pour partir d'un fichier sources package t pour partir d\"un tarball On build avec RPM : rpmbuild -tb rsync-3.y.z.tar.gz Exemple du fichier SPEC modifi\u00e9 : Attention, le %files n'accepte pas les doubles fichiers sur la m\u00eame ligne : RPM -ivh (v pour verbose ; h pour la barre de progressions) Package rsync (vide) \u00b6 Installation de rpmdev : dnf -y install rpmdevtools Cr\u00e9ation du fichier (--output pour set le nom et l'endoit du fichier) : rpmdev-newspec --type minimal --output rpmbuild/SPECS/vide.spec Modification du fichier SPEC : Cr\u00e9ation d'un repo \u00b6 Installation de la commande createrepo : dnf install creatrepo_c Installation du repo : Createrepo rpmbuild/RPMS Lancement d'un conteneur docker en restart always : docker container run -d --name repo --publish 8001:80 --volume /root/rpmbuild/RPMS/:/usr/local/apache2/htdocs --restart always httpd Cr\u00e9er le fichier /etc/yum.repos.d/mondepot.repo 1 2 3 [mondepot] name = Mon beau d\u00e9pot baseurl = http://IP:8001","title":"Programme du jour"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#programme-du-jour","text":"Manipuler rpm et yum Compiler un logiciel libre (\u00e0 partir des sources) Cr\u00e9er un pakcage RPM Cr\u00e9er un d\u00e9p\u00f4t pour mettre \u00e0 dispo mes packages D\u00e9clarer mon d\u00e9p\u00f4t sur les pc clients","title":"Programme du jour"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#manipuler-rpm-et-yum","text":"","title":"Manipuler rpm et yum"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#rpm","text":"RPM : commande pour manipuler des package et savoir les informations sur ceux-ci Options : -q query => Information de version -qi => descriptif sur le paquage -qa => liste de tout les paquages install\u00e9s -ql => liste des fihcier install\u00e9 le paquet -qc => Liste des fihciers de config -qd => Liste des fichiers de docs -qf => savoir quel fichier \u00e0 install\u00e9 le package --requires (-R) => savoir les paquages dont il a besoin --provides (-P) => d\u00e9pendances pour qui ? --scripts => fichier spec avec les scripts de d\u00e9sinstall, install, preinstall","title":"RPM"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#yum","text":"Yum : surcouche de rpm DNF = reprise de yum qui etait sur python 2.3 Options : install update upgrade (attention cela peut remplacer des paquets) remove list (liste tout les paquets) search (liste les paquets avec par exemple http dans les descriptions) provides Extraire une archive test de l'archive tar -tvzf ARCHIVE | tail options : - t pour tester ou lister (--list) - v versbose - f file - z compression - x pour extraire Le tail est utilis\u00e9 pour etre sur que tout les fichiers soient dans le meme dossier racine Extraction tar -xvzf ARCHIVE","title":"YUM"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#verification-des-signatures-gpg","text":"Importer la cl\u00e9 avec WGET : wget https://download.samba.org/pub/rsync/src/rsync-3.2.7.tar.gz.asc Verification de la signature : gpg --verify rsync-3.2.7.tar.gz.asc Copie de la cl\u00e9 pour enregistrer la cl\u00e9 via un serveur de cl\u00e9s gpg --receive-keys 0048C8B026D4C96F0E589C2F6C859FB14B96A8C5 V\u00e9rifier \u00e0 nouveau la cl\u00e9","title":"Verification des signatures GPG :"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#paquet-rsync","text":"Erreurs lors de la configuration Installation de GCC compilateur C dnf -y install gcc Nouvelle erreur lors de la configuration : On cherche les paquets openssl : yum provides \"*/openssl/md4.h\" On trouve ensuite les paquets openssl-devel dnf -y install gcc openssl-devel On retrouve plusieurs erreurs suppl\u00e9mentaires zstd lz4 xxhash Pour xxhash on va sur le site https://pkgs.org et on cherche un paquet qui se rapporte xxhash-devel On trouve le repo CRB : Commande compl\u00e8te avec tout les arguments : dnf --enablerepo=\"crb\" -y install gcc openssl-devel lz4-devel libzstd-devel xxhash-devel On retrouve ensuite le code retour avec la configuration termin\u00e9e : epel-release permet d'aller chercher des paquets qui ne sont pas soutenu par REDHAT mais par une autre communaut\u00e9 comme la communaut\u00e9 FEDORA Petite astuce pour savoir le nombre de coeur : grep -c ^processor /proc/cpuinfo","title":"Paquet rsync"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#rpm-build","text":"","title":"RPM build"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#package-rsync-non-vide","text":"3 options : b pour partir d'un fichier spec r pour partir d'un fichier sources package t pour partir d\"un tarball On build avec RPM : rpmbuild -tb rsync-3.y.z.tar.gz Exemple du fichier SPEC modifi\u00e9 : Attention, le %files n'accepte pas les doubles fichiers sur la m\u00eame ligne : RPM -ivh (v pour verbose ; h pour la barre de progressions)","title":"Package rsync (non vide)"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#package-rsync-vide","text":"Installation de rpmdev : dnf -y install rpmdevtools Cr\u00e9ation du fichier (--output pour set le nom et l'endoit du fichier) : rpmdev-newspec --type minimal --output rpmbuild/SPECS/vide.spec Modification du fichier SPEC :","title":"Package rsync (vide)"},{"location":"Linux/Master/Administration%20avanc%C3%A9e/RPM-YUM/Index/#creation-dun-repo","text":"Installation de la commande createrepo : dnf install creatrepo_c Installation du repo : Createrepo rpmbuild/RPMS Lancement d'un conteneur docker en restart always : docker container run -d --name repo --publish 8001:80 --volume /root/rpmbuild/RPMS/:/usr/local/apache2/htdocs --restart always httpd Cr\u00e9er le fichier /etc/yum.repos.d/mondepot.repo 1 2 3 [mondepot] name = Mon beau d\u00e9pot baseurl = http://IP:8001","title":"Cr\u00e9ation d'un repo"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Commandes%20dans%20kubernetes/","text":"Commandes dans Kubernetes \u00b6 Changement de l'espace de travail kubectl config set-context --current --namespace kube-system Cr\u00e9ation d'un espace de travail kubectl create namespace leo Se situer dans l'environement kubectl config get-contexts Cr\u00e9ation d'un d\u00e9ployment kubectl create deployment --image nginx:latest --port 80 nginx Lister les deployments kubectl get deployments Lister les pods de mani\u00e8re simple kubectl get pods Lister les pods de mani\u00e8re plus compl\u00e8te kubectl get pods -o wide Cr\u00e9ation d'un service kubectl create service loadbalancer --tcp 80 :80 ngnix Recuprer le service kubectl get service Edition du r\u00e9plicat kubectl scale --replicas = 3 deployment nginx D\u00e9ployement d'un template kubectl apply -f ./Deployment_whomi.yml Voir les logs d'un pod kubectl logs -f whoami Voir les logs d'un pod avec le label kubectl logs -f -l app = whoami Passer en mode exectution dans le pod kubectl exec -it nginx-deployment -- sh","title":"Commandes dans Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Commandes%20dans%20kubernetes/#commandes-dans-kubernetes","text":"Changement de l'espace de travail kubectl config set-context --current --namespace kube-system Cr\u00e9ation d'un espace de travail kubectl create namespace leo Se situer dans l'environement kubectl config get-contexts Cr\u00e9ation d'un d\u00e9ployment kubectl create deployment --image nginx:latest --port 80 nginx Lister les deployments kubectl get deployments Lister les pods de mani\u00e8re simple kubectl get pods Lister les pods de mani\u00e8re plus compl\u00e8te kubectl get pods -o wide Cr\u00e9ation d'un service kubectl create service loadbalancer --tcp 80 :80 ngnix Recuprer le service kubectl get service Edition du r\u00e9plicat kubectl scale --replicas = 3 deployment nginx D\u00e9ployement d'un template kubectl apply -f ./Deployment_whomi.yml Voir les logs d'un pod kubectl logs -f whoami Voir les logs d'un pod avec le label kubectl logs -f -l app = whoami Passer en mode exectution dans le pod kubectl exec -it nginx-deployment -- sh","title":"Commandes dans Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Syntaxe%20fichier%20deployment%20et%20services/","text":"Syntaxe du deployment \u00b6 apiVersion : apps/v1 kind : Deployment metadata : name : nginx-deployment labels : app : nginx spec : replicas : 3 selector : matchLabels : app : nginx template : metadata : labels : app : nginx spec : containers : - name : nginx image : nginx:1.14.2 ports : - containerPort : 80 Syntaxe du service \u00b6 apiVersion : v1 kind : Service metadata : name : my-service spec : selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 Exemple de fichier complet \u00b6 apiVersion : apps/v1 kind : Deployment metadata : name : whoami-deployment labels : app : whoami spec : replicas : 3 selector : matchLabels : app : whoami template : metadata : labels : app : whoami spec : containers : - name : whoami image : traefik/whoami:latest ports : - containerPort : 80 protocol : TCP --- apiVersion : v1 kind : Service metadata : name : whoami-service spec : selector : app : whoami ports : - protocol : TCP port : 80 targetPort : 80 type : LoadBalancer Exemple avec modification de ports \u00b6 apiVersion : apps/v1 kind : Deployment metadata : name : whoami-deployment labels : app : whoami spec : replicas : 3 selector : matchLabels : app : whoami template : metadata : labels : app : whoami spec : containers : - name : whoami image : traefik/whoami:latest env : - name : WHOAMI_PORT_NUMBER value : \"1234\" ports : - containerPort : 1234 protocol : TCP --- apiVersion : v1 kind : Service metadata : name : whoami-service spec : selector : app : whoami ports : - protocol : TCP port : 80 targetPort : 1234 type : LoadBalancer","title":"Syntaxe fichier deployment et services"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Syntaxe%20fichier%20deployment%20et%20services/#syntaxe-du-deployment","text":"apiVersion : apps/v1 kind : Deployment metadata : name : nginx-deployment labels : app : nginx spec : replicas : 3 selector : matchLabels : app : nginx template : metadata : labels : app : nginx spec : containers : - name : nginx image : nginx:1.14.2 ports : - containerPort : 80","title":"Syntaxe du deployment"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Syntaxe%20fichier%20deployment%20et%20services/#syntaxe-du-service","text":"apiVersion : v1 kind : Service metadata : name : my-service spec : selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376","title":"Syntaxe du service"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Syntaxe%20fichier%20deployment%20et%20services/#exemple-de-fichier-complet","text":"apiVersion : apps/v1 kind : Deployment metadata : name : whoami-deployment labels : app : whoami spec : replicas : 3 selector : matchLabels : app : whoami template : metadata : labels : app : whoami spec : containers : - name : whoami image : traefik/whoami:latest ports : - containerPort : 80 protocol : TCP --- apiVersion : v1 kind : Service metadata : name : whoami-service spec : selector : app : whoami ports : - protocol : TCP port : 80 targetPort : 80 type : LoadBalancer","title":"Exemple de fichier complet"},{"location":"Vitrualisation%20%26%20cloud/Commandes/Syntaxe%20fichier%20deployment%20et%20services/#exemple-avec-modification-de-ports","text":"apiVersion : apps/v1 kind : Deployment metadata : name : whoami-deployment labels : app : whoami spec : replicas : 3 selector : matchLabels : app : whoami template : metadata : labels : app : whoami spec : containers : - name : whoami image : traefik/whoami:latest env : - name : WHOAMI_PORT_NUMBER value : \"1234\" ports : - containerPort : 1234 protocol : TCP --- apiVersion : v1 kind : Service metadata : name : whoami-service spec : selector : app : whoami ports : - protocol : TCP port : 80 targetPort : 1234 type : LoadBalancer","title":"Exemple avec modification de ports"},{"location":"Vitrualisation%20%26%20cloud/Rappels/Rappel%20sur%20la%20virtualisation/","text":"La vitrualisation \u00b6 Rappel sur les VM et les conteneurs \u00b6 Diff\u00e9rence entre la VM et le conteneur \u00b6 Rappel sur la virtualisation et les conteneurs Les VM h\u00e9bergent un syst\u00e8me virtuel complet comprenant le hardware (physique) et l'OS (Op\u00e9rating Syst\u00e8me). Cot\u00e9 conteneurs, celui-ci est utilis\u00e9 pour : la performance les ressources Facilite la MCO ( + vite , + leger et un versionning avanc\u00e9) Le prix Gain d'agilit\u00e9 Mise \u00e0 l'\u00e9chelle plus facile Les conteneurs d\u00e9pendent d'une seule et unique application. Principe du conteneur L'architecture des conteneur d\u00e9taill\u00e9 \u00b6 Le conteneur poss\u00e8de tout son environement tout autour de l'application Principe du conteneur - Architecture","title":"La vitrualisation"},{"location":"Vitrualisation%20%26%20cloud/Rappels/Rappel%20sur%20la%20virtualisation/#la-vitrualisation","text":"","title":"La vitrualisation"},{"location":"Vitrualisation%20%26%20cloud/Rappels/Rappel%20sur%20la%20virtualisation/#rappel-sur-les-vm-et-les-conteneurs","text":"","title":"Rappel sur les VM et les conteneurs"},{"location":"Vitrualisation%20%26%20cloud/Rappels/Rappel%20sur%20la%20virtualisation/#difference-entre-la-vm-et-le-conteneur","text":"Rappel sur la virtualisation et les conteneurs Les VM h\u00e9bergent un syst\u00e8me virtuel complet comprenant le hardware (physique) et l'OS (Op\u00e9rating Syst\u00e8me). Cot\u00e9 conteneurs, celui-ci est utilis\u00e9 pour : la performance les ressources Facilite la MCO ( + vite , + leger et un versionning avanc\u00e9) Le prix Gain d'agilit\u00e9 Mise \u00e0 l'\u00e9chelle plus facile Les conteneurs d\u00e9pendent d'une seule et unique application. Principe du conteneur","title":"Diff\u00e9rence entre la VM et le conteneur"},{"location":"Vitrualisation%20%26%20cloud/Rappels/Rappel%20sur%20la%20virtualisation/#larchitecture-des-conteneur-detaille","text":"Le conteneur poss\u00e8de tout son environement tout autour de l'application Principe du conteneur - Architecture","title":"L'architecture des conteneur d\u00e9taill\u00e9"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/","text":"Kubernetes \u00b6 D\u00e9finition \u00b6 Kubernetes est une solution Open Source permettant l'orchestration de ressources conteneuris\u00e9es. Cette solution est une solution d\u00e9velopp\u00e9e par Google et elle \u00e0 \u00e9t\u00e9 offert \u00e0 la Linux Fondation (2014). Par la suite la CNCF (Cloud Native Computing Fondation) \u00e0 \u00e9t\u00e9 cr\u00e9e en 2015. D\u00e9finition de kubernetes par la CNCF Kubernetes est ue plateforme open source extensible et portable pour la gestion de charge de trvail et de service conteneuris\u00e9s. Autres plateformes \u00b6 On retrouve plusieurs plateformes encore active aujourd'hui contrairement \u00e0 Docker Swarm, Mesos ... Les solutions actuelles : Titus, solution utilis\u00e9e par Netflix Nomad, soltion en voggue propuls\u00e9e par Hashicorp Apache Mesos , solution propos\u00e9e par Apache Fonctionnement de Kubernetes \u00b6 Architecture de kubernetes \u00b6 Termes utilis\u00e9s dans Kubernetes \u00b6 Terme Signification Master (ou control-plane) Permet de g\u00e9rer le syst\u00e8mes Workers Permet d'executer l'applicatif ETCD Magasin de valeurs cl\u00e9s coh\u00e9rent et hautement disponible Scheduleur Assure les diff\u00e9rentes contraintes (arret, d\u00e9marrage des conteneurs) Controller Manager Gestion des droits API-SERVER Centre n\u00e9vralgique de kubernetes Kube proxy Assure le r\u00e9seau, la communication avec l'api-server Kubelet Seul composant non contenuris\u00e9. Service systemctl qui va communiquer avec le moteur de contenurisation container Ressource ex\u00e9cutant une application pod Groupement d'un ou plusieurs conteneurs deployment Orchestre les pods et replicaSets deamonset S'assure d'avoir un pod sur chaque noeud statefullset [legacy] S'assure de n'avoir qu'un seul pod service Explose votre application sur le r\u00e9seau du cluster ingress Permet d'exposer un service en externe (#reverseProxy) persistent volumes claims Demande d'allocation de stockage configMaps stockage cl\u00e9-valeur non confidentiel secrets stockage cl\u00e9-valeur confidentiel Objets de kubernetes \u00b6","title":"Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#kubernetes","text":"","title":"Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#definition","text":"Kubernetes est une solution Open Source permettant l'orchestration de ressources conteneuris\u00e9es. Cette solution est une solution d\u00e9velopp\u00e9e par Google et elle \u00e0 \u00e9t\u00e9 offert \u00e0 la Linux Fondation (2014). Par la suite la CNCF (Cloud Native Computing Fondation) \u00e0 \u00e9t\u00e9 cr\u00e9e en 2015. D\u00e9finition de kubernetes par la CNCF Kubernetes est ue plateforme open source extensible et portable pour la gestion de charge de trvail et de service conteneuris\u00e9s.","title":"D\u00e9finition"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#autres-plateformes","text":"On retrouve plusieurs plateformes encore active aujourd'hui contrairement \u00e0 Docker Swarm, Mesos ... Les solutions actuelles : Titus, solution utilis\u00e9e par Netflix Nomad, soltion en voggue propuls\u00e9e par Hashicorp Apache Mesos , solution propos\u00e9e par Apache","title":"Autres plateformes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#fonctionnement-de-kubernetes","text":"","title":"Fonctionnement de Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#architecture-de-kubernetes","text":"","title":"Architecture de kubernetes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#termes-utilises-dans-kubernetes","text":"Terme Signification Master (ou control-plane) Permet de g\u00e9rer le syst\u00e8mes Workers Permet d'executer l'applicatif ETCD Magasin de valeurs cl\u00e9s coh\u00e9rent et hautement disponible Scheduleur Assure les diff\u00e9rentes contraintes (arret, d\u00e9marrage des conteneurs) Controller Manager Gestion des droits API-SERVER Centre n\u00e9vralgique de kubernetes Kube proxy Assure le r\u00e9seau, la communication avec l'api-server Kubelet Seul composant non contenuris\u00e9. Service systemctl qui va communiquer avec le moteur de contenurisation container Ressource ex\u00e9cutant une application pod Groupement d'un ou plusieurs conteneurs deployment Orchestre les pods et replicaSets deamonset S'assure d'avoir un pod sur chaque noeud statefullset [legacy] S'assure de n'avoir qu'un seul pod service Explose votre application sur le r\u00e9seau du cluster ingress Permet d'exposer un service en externe (#reverseProxy) persistent volumes claims Demande d'allocation de stockage configMaps stockage cl\u00e9-valeur non confidentiel secrets stockage cl\u00e9-valeur confidentiel","title":"Termes utilis\u00e9s dans Kubernetes"},{"location":"Vitrualisation%20%26%20cloud/kube/Informations%20sur%20kubernetes/#objets-de-kubernetes","text":"","title":"Objets de kubernetes"},{"location":"Windows/Active%20directory/GPO/","text":"Nous avons un script \u00e0 d\u00e9ployer sur toutes les machines du domaine. Ce script doit : S'executer au d\u00e9marrage de la session Les utilisateurs dans les OU choisi doivent avoir se script Info OU = Unit\u00e9 d'organisation Cr\u00e9ation d'un OU \u00b6 Pour cr\u00e9er un OU, le serveur (ici un Windows serveur 2019) doit \u00eatre un serveur AD. Le serveur AD doit \u00eatre promu en contr\u00f4leur de domaine. La cr\u00e9ation d'OU, intervient dans les outils du gestionnaire de serveur puis dans dans gestion des strat\u00e9gies de groupe . Outils de l'AD On obtient ensuite une fen\u00eatre avec la for\u00eat. Gestion des strat\u00e9gies de groupes On utlise ensuite le clic droit -> Nouvelle unit\u00e9 d'organsiation Cr\u00e9ation de l'OU Donnez ensuite un nom \u00e0 votre OU. On retrouve cette OU dans la foret sous les domaines Unit\u00e9 organisation 1 Cr\u00e9ation de la GPO \u00b6 Une fois l'OU cr\u00e9e, vous pouvez vous positionner sur celle-ci et faire Clic droit -> Cr\u00e9\u00e9r un objet GPO Mettez un nom \u00e0 cette GPO. Cr\u00e9ation de la GPO Faites clic droit sur la GPO puis modifier l\u00e0. Ici nous allons dans les strat\u00e9gies de scripts d'ouverture de sessions. Localisation des scripts d'ouverture de sessions On ajoute le script (ici un script powershell) dans l'onglet Powershell. Quand on met un script, il faut garder le dossier par d\u00e9faut et mettre le script dans ce dossier. \\\\AD-LG.local\\SysVol\\AD-LG.local\\Policies\\{53DB8C41-12CE-42EE-9DD9-509CA44D262A}\\User\\Scripts\\Logon Ici le chemin avec le num\u00e9ro de la GPO. On v\u00e9rifie ensuite le nom du script. Onglet powershell Sur la machine cliente, on peux voir avec un GPRESULT /R l'\u00e9tat de la GPO. On v\u00e9rifie que la GPO espion est bien pr\u00e9sent. Verificiation du scripts d'ouverture de sessions","title":"GPO"},{"location":"Windows/Active%20directory/GPO/#creation-dun-ou","text":"Pour cr\u00e9er un OU, le serveur (ici un Windows serveur 2019) doit \u00eatre un serveur AD. Le serveur AD doit \u00eatre promu en contr\u00f4leur de domaine. La cr\u00e9ation d'OU, intervient dans les outils du gestionnaire de serveur puis dans dans gestion des strat\u00e9gies de groupe . Outils de l'AD On obtient ensuite une fen\u00eatre avec la for\u00eat. Gestion des strat\u00e9gies de groupes On utlise ensuite le clic droit -> Nouvelle unit\u00e9 d'organsiation Cr\u00e9ation de l'OU Donnez ensuite un nom \u00e0 votre OU. On retrouve cette OU dans la foret sous les domaines Unit\u00e9 organisation 1","title":"Cr\u00e9ation d'un OU"},{"location":"Windows/Active%20directory/GPO/#creation-de-la-gpo","text":"Une fois l'OU cr\u00e9e, vous pouvez vous positionner sur celle-ci et faire Clic droit -> Cr\u00e9\u00e9r un objet GPO Mettez un nom \u00e0 cette GPO. Cr\u00e9ation de la GPO Faites clic droit sur la GPO puis modifier l\u00e0. Ici nous allons dans les strat\u00e9gies de scripts d'ouverture de sessions. Localisation des scripts d'ouverture de sessions On ajoute le script (ici un script powershell) dans l'onglet Powershell. Quand on met un script, il faut garder le dossier par d\u00e9faut et mettre le script dans ce dossier. \\\\AD-LG.local\\SysVol\\AD-LG.local\\Policies\\{53DB8C41-12CE-42EE-9DD9-509CA44D262A}\\User\\Scripts\\Logon Ici le chemin avec le num\u00e9ro de la GPO. On v\u00e9rifie ensuite le nom du script. Onglet powershell Sur la machine cliente, on peux voir avec un GPRESULT /R l'\u00e9tat de la GPO. On v\u00e9rifie que la GPO espion est bien pr\u00e9sent. Verificiation du scripts d'ouverture de sessions","title":"Cr\u00e9ation de la GPO"},{"location":"Windows/Powershell/Cr%C3%A9ation%20d%27un%20dossier%2Bscript/","text":"Verification \u00b6 Dans cette partie, on va v\u00e9rifier si un dossier est cr\u00e9e \u00e0\u00f9 non. Pour test si un dossier existe, on va utiliser Get-Item : $retour = Get-Item -Path \"c:/log\" -ErrorAction SilentlyContinue Ici, on stocke la valeur rendu par la commande dans $retour . On va ensuite aller chercher le dossier c:/log . On va s'assurer que la commande s'excute en silence m\u00eame si il y a des erreurs avec -ErrorAction SilentlyContinue Note Ici nous utilisons un dossier qui n'existe pas. Le but de cette activit\u00e9 est de cr\u00e9er un script qui quand il ne trouve pas le dossier c:/log , il cr\u00e9e un dossier. Dans ce dossier, nous souhaitons qu'il y ai un fichier nomm\u00e9 'ESPION.txt'. On va donc cr\u00e9er un dossier \u00e0 la racine si celui-ci n'existe pas : if (!( Get-Item -Path \"c:\\log\" -ErrorAction SilentlyContinue )) { New-Item \"c:\\log\" -ItemType Directory } On v\u00e9rifie ensuite si le fichier espion.txt existe dans le dossier c:\\log : if (!( Get-Item -Path \"c:\\log\\espion.txt\" -ErrorAction SilentlyContinue )) { New-Item -Path \"c:\\log\\espion.txt\" -ItemType File } On r\u00e9alise ensuite le script complet avec l'impl\u00e9mentation du user et de la date/heure : if (!( Get-Item -Path \"c:\\log\" -ErrorAction SilentlyContinue )) { New-Item \"c:\\log\" -ItemType Directory } if (!( Get-Item -Path \"c:\\log\\espion.txt\" -ErrorAction SilentlyContinue )) { New-Item -Path \"c:\\log\\espion.txt\" -ItemType File } $export = \"{0,-20}:{1:yyyy}:{2}:{3}:{4}:{5}:{6}\" -f $env:USERNAME , ( Get-Date ),( Get-Date ). Month ,( Get-Date ). Day ,( Get-Date ). Hour ,( Get-Date ). Minute , ( Get-Date ). DayOfWeek Write-Output $export ADD-content -path \"c:\\log\\espion.txt\" -value $export Note Le ADD-content -path \"c:\\log\\espion.txt\" -value $export permet d'\u00e9crit dans le fichier espion.txt","title":"Cr\u00e9ation d'un dossier+script"},{"location":"Windows/Powershell/Cr%C3%A9ation%20d%27un%20dossier%2Bscript/#verification","text":"Dans cette partie, on va v\u00e9rifier si un dossier est cr\u00e9e \u00e0\u00f9 non. Pour test si un dossier existe, on va utiliser Get-Item : $retour = Get-Item -Path \"c:/log\" -ErrorAction SilentlyContinue Ici, on stocke la valeur rendu par la commande dans $retour . On va ensuite aller chercher le dossier c:/log . On va s'assurer que la commande s'excute en silence m\u00eame si il y a des erreurs avec -ErrorAction SilentlyContinue Note Ici nous utilisons un dossier qui n'existe pas. Le but de cette activit\u00e9 est de cr\u00e9er un script qui quand il ne trouve pas le dossier c:/log , il cr\u00e9e un dossier. Dans ce dossier, nous souhaitons qu'il y ai un fichier nomm\u00e9 'ESPION.txt'. On va donc cr\u00e9er un dossier \u00e0 la racine si celui-ci n'existe pas : if (!( Get-Item -Path \"c:\\log\" -ErrorAction SilentlyContinue )) { New-Item \"c:\\log\" -ItemType Directory } On v\u00e9rifie ensuite si le fichier espion.txt existe dans le dossier c:\\log : if (!( Get-Item -Path \"c:\\log\\espion.txt\" -ErrorAction SilentlyContinue )) { New-Item -Path \"c:\\log\\espion.txt\" -ItemType File } On r\u00e9alise ensuite le script complet avec l'impl\u00e9mentation du user et de la date/heure : if (!( Get-Item -Path \"c:\\log\" -ErrorAction SilentlyContinue )) { New-Item \"c:\\log\" -ItemType Directory } if (!( Get-Item -Path \"c:\\log\\espion.txt\" -ErrorAction SilentlyContinue )) { New-Item -Path \"c:\\log\\espion.txt\" -ItemType File } $export = \"{0,-20}:{1:yyyy}:{2}:{3}:{4}:{5}:{6}\" -f $env:USERNAME , ( Get-Date ),( Get-Date ). Month ,( Get-Date ). Day ,( Get-Date ). Hour ,( Get-Date ). Minute , ( Get-Date ). DayOfWeek Write-Output $export ADD-content -path \"c:\\log\\espion.txt\" -value $export Note Le ADD-content -path \"c:\\log\\espion.txt\" -value $export permet d'\u00e9crit dans le fichier espion.txt","title":"Verification"},{"location":"Windows/Powershell/Cr%C3%A9ation%20fichier%20avec%20user%20%2B%20date/","text":"Comment obtenir la date en Powershell \u00b6 On utilise la commande : 1 Get-Date R\u00e9sultat de la commande Get-date Obtenir certaines informations d'apr\u00e8s une commande \u00b6 Note Les op\u00e9rateurs sont r\u00e9f\u00e9renc\u00e9s sur le site : https://ss64.com/ps/ On souhaite r\u00e9cup\u00e9rer les diff\u00e9rents membre de la date affich\u00e9e par powershell : 1 Get-Date | Get-Member R\u00e9sultat de la damande des membres Dans le cas de la commande Get-member et de Powershell en g\u00e9n\u00e9ral, nous avons un language orient\u00e9 objet. On r\u00e9cup\u00e8re les quelques informations : 1 Get-Date | Select-Object -Property Year , Month , Day Cette commande nous donne un tableau de valeur : Tableau de date On stocke la valeur dans une variable temporaire : 1 2 3 $DATE = Get-Date $DATE . Day On r\u00e9cup\u00e8re uniquement la valeur de la date. Info On peux aussi r\u00e9cup\u00e8rer la valeur d'un autre fa\u00e7on : ( Get-Date ). Day Cherche une chaine de caract\u00e8res : Get-Date -UFormat \"%Y:%m:%d:%R:%A\" Chaine de caract\u00e8re obtenue On prend le nom d'utilisateur : 1 $env:USERNAME On va ensuite aller chercher les diff\u00e9rentes informations avec leur position : 1 \"{0,-20}:{1:yyyy}:{2:MM}\" -f $env:USERNAME , ( Get-Date ). Year , ( Get-Date ). Month Info On utilise les {} pour donner la position + le formatage L'option -f permet de r\u00e9aliser le formatage Les diff\u00e9rentes informations sont s\u00e9par\u00e9es par une virgule , Pour afficher et cr\u00e9er un fichier avec les informations voulue : 1 2 3 4 5 6 7 8 9 10 11 12 $export = \"{0,-20}:{1:yyyy}:{2}:{3}:{4}\" -f $env:USERNAME , ( Get-Date ),( Get-Date ). Month ,( Get-Date ). Day ,( Get-Date ). DayOfWeek Write-Output $export # Export dans un txt # On verifi si le fichier existe $file = \".\\export.txt\" if (!( Test-Path -Path $file )){ #Si il existe pas on le cr\u00e9er New-Item -Path $file } # On ajoute notre ligne dans le fichier ADD-content -path $file -value $export","title":"Cr\u00e9ation fichier avec user + date"},{"location":"Windows/Powershell/Cr%C3%A9ation%20fichier%20avec%20user%20%2B%20date/#comment-obtenir-la-date-en-powershell","text":"On utilise la commande : 1 Get-Date R\u00e9sultat de la commande Get-date","title":"Comment obtenir la date en Powershell"},{"location":"Windows/Powershell/Cr%C3%A9ation%20fichier%20avec%20user%20%2B%20date/#obtenir-certaines-informations-dapres-une-commande","text":"Note Les op\u00e9rateurs sont r\u00e9f\u00e9renc\u00e9s sur le site : https://ss64.com/ps/ On souhaite r\u00e9cup\u00e9rer les diff\u00e9rents membre de la date affich\u00e9e par powershell : 1 Get-Date | Get-Member R\u00e9sultat de la damande des membres Dans le cas de la commande Get-member et de Powershell en g\u00e9n\u00e9ral, nous avons un language orient\u00e9 objet. On r\u00e9cup\u00e8re les quelques informations : 1 Get-Date | Select-Object -Property Year , Month , Day Cette commande nous donne un tableau de valeur : Tableau de date On stocke la valeur dans une variable temporaire : 1 2 3 $DATE = Get-Date $DATE . Day On r\u00e9cup\u00e8re uniquement la valeur de la date. Info On peux aussi r\u00e9cup\u00e8rer la valeur d'un autre fa\u00e7on : ( Get-Date ). Day Cherche une chaine de caract\u00e8res : Get-Date -UFormat \"%Y:%m:%d:%R:%A\" Chaine de caract\u00e8re obtenue On prend le nom d'utilisateur : 1 $env:USERNAME On va ensuite aller chercher les diff\u00e9rentes informations avec leur position : 1 \"{0,-20}:{1:yyyy}:{2:MM}\" -f $env:USERNAME , ( Get-Date ). Year , ( Get-Date ). Month Info On utilise les {} pour donner la position + le formatage L'option -f permet de r\u00e9aliser le formatage Les diff\u00e9rentes informations sont s\u00e9par\u00e9es par une virgule , Pour afficher et cr\u00e9er un fichier avec les informations voulue : 1 2 3 4 5 6 7 8 9 10 11 12 $export = \"{0,-20}:{1:yyyy}:{2}:{3}:{4}\" -f $env:USERNAME , ( Get-Date ),( Get-Date ). Month ,( Get-Date ). Day ,( Get-Date ). DayOfWeek Write-Output $export # Export dans un txt # On verifi si le fichier existe $file = \".\\export.txt\" if (!( Test-Path -Path $file )){ #Si il existe pas on le cr\u00e9er New-Item -Path $file } # On ajoute notre ligne dans le fichier ADD-content -path $file -value $export","title":"Obtenir certaines informations d'apr\u00e8s une commande"}]}